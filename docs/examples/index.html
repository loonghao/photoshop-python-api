
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <meta name="author" content="longhao">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.2, mkdocs-material-7.2.3">
    
    
      
        <title>Examples - Photoshop Python API</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.f7f47774.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.3f5d1f46.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
    
      


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    <script>function __prefix(e){return new URL("..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#examples" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Photoshop Python API" class="md-header__button md-logo" aria-label="Photoshop Python API" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Photoshop Python API
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Examples
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/loonghao/photoshop-python-api/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    github
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Photoshop Python API" class="md-nav__button md-logo" aria-label="Photoshop Python API" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Photoshop Python API
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/loonghao/photoshop-python-api/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    github
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Introduction
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Examples
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Examples
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#active-layer" class="md-nav__link">
    Active Layer
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#add-metadata" class="md-nav__link">
    Add Metadata
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#add-slate" class="md-nav__link">
    Add Slate
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#add-start-application-event" class="md-nav__link">
    Add Start Application Event
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#apply-crystallize-filter-action" class="md-nav__link">
    Apply Crystallize Filter Action
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#apply-filters" class="md-nav__link">
    Apply Filters
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#change-color-of-background-and-foreground" class="md-nav__link">
    Change Color Of Background And Foreground
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#color" class="md-nav__link">
    Color
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#compare-colors" class="md-nav__link">
    Compare Colors
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#copy-and-paste" class="md-nav__link">
    Copy And Paste
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#create-new-document" class="md-nav__link">
    Create New Document
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#create-thumbnail" class="md-nav__link">
    Create Thumbnail
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creating-a-layer" class="md-nav__link">
    Creating A Layer
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cropping" class="md-nav__link">
    Cropping
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#current-tool" class="md-nav__link">
    Current Tool
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#do-photoshop-action" class="md-nav__link">
    Do Photoshop Action
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#emboss-action" class="md-nav__link">
    Emboss Action
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#enable-generator" class="md-nav__link">
    Enable Generator
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#eval-javascript" class="md-nav__link">
    Eval Javascript
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#export-layers-as-png" class="md-nav__link">
    Export Layers As Png
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fill-selection" class="md-nav__link">
    Fill Selection
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fit-on-screen" class="md-nav__link">
    Fit On Screen
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hello-world" class="md-nav__link">
    Hello World
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#import-image-as-layer" class="md-nav__link">
    Import Image As Layer
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#link-layer" class="md-nav__link">
    Link Layer
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#list-documents" class="md-nav__link">
    List Documents
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#load-selection" class="md-nav__link">
    Load Selection
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#move-to-end" class="md-nav__link">
    Move To End
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#new-document" class="md-nav__link">
    New Document
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#open-psd" class="md-nav__link">
    Open Psd
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#operation-channels" class="md-nav__link">
    Operation Channels
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#operation-layer-set" class="md-nav__link">
    Operation Layer Set
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#photoshop-session" class="md-nav__link">
    Photoshop Session
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#replace-images" class="md-nav__link">
    Replace Images
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rotate-layer" class="md-nav__link">
    Rotate Layer
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#save-as-pdf" class="md-nav__link">
    Save As Pdf
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#save-as-tga" class="md-nav__link">
    Save As Tga
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#save-to-psd" class="md-nav__link">
    Save To Psd
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#selection-stroke" class="md-nav__link">
    Selection Stroke
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#session-callback" class="md-nav__link">
    Session Callback
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#session-document-duplicate" class="md-nav__link">
    Session Document Duplicate
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#session-hello-world" class="md-nav__link">
    Session Hello World
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#session-new-document" class="md-nav__link">
    Session New Document
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#session-smart-sharpen" class="md-nav__link">
    Session Smart Sharpen
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#set-active-layer" class="md-nav__link">
    Set Active Layer
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#smart-sharpen" class="md-nav__link">
    Smart Sharpen
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#toggle-proof-colors" class="md-nav__link">
    Toggle Proof Colors
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#trim" class="md-nav__link">
    Trim
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/loonghao/photoshop-python-api/issues" class="md-nav__link">
        Issue Tracker
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#active-layer" class="md-nav__link">
    Active Layer
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#add-metadata" class="md-nav__link">
    Add Metadata
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#add-slate" class="md-nav__link">
    Add Slate
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#add-start-application-event" class="md-nav__link">
    Add Start Application Event
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#apply-crystallize-filter-action" class="md-nav__link">
    Apply Crystallize Filter Action
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#apply-filters" class="md-nav__link">
    Apply Filters
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#change-color-of-background-and-foreground" class="md-nav__link">
    Change Color Of Background And Foreground
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#color" class="md-nav__link">
    Color
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#compare-colors" class="md-nav__link">
    Compare Colors
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#copy-and-paste" class="md-nav__link">
    Copy And Paste
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#create-new-document" class="md-nav__link">
    Create New Document
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#create-thumbnail" class="md-nav__link">
    Create Thumbnail
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creating-a-layer" class="md-nav__link">
    Creating A Layer
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cropping" class="md-nav__link">
    Cropping
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#current-tool" class="md-nav__link">
    Current Tool
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#do-photoshop-action" class="md-nav__link">
    Do Photoshop Action
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#emboss-action" class="md-nav__link">
    Emboss Action
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#enable-generator" class="md-nav__link">
    Enable Generator
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#eval-javascript" class="md-nav__link">
    Eval Javascript
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#export-layers-as-png" class="md-nav__link">
    Export Layers As Png
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fill-selection" class="md-nav__link">
    Fill Selection
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fit-on-screen" class="md-nav__link">
    Fit On Screen
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hello-world" class="md-nav__link">
    Hello World
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#import-image-as-layer" class="md-nav__link">
    Import Image As Layer
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#link-layer" class="md-nav__link">
    Link Layer
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#list-documents" class="md-nav__link">
    List Documents
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#load-selection" class="md-nav__link">
    Load Selection
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#move-to-end" class="md-nav__link">
    Move To End
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#new-document" class="md-nav__link">
    New Document
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#open-psd" class="md-nav__link">
    Open Psd
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#operation-channels" class="md-nav__link">
    Operation Channels
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#operation-layer-set" class="md-nav__link">
    Operation Layer Set
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#photoshop-session" class="md-nav__link">
    Photoshop Session
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#replace-images" class="md-nav__link">
    Replace Images
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rotate-layer" class="md-nav__link">
    Rotate Layer
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#save-as-pdf" class="md-nav__link">
    Save As Pdf
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#save-as-tga" class="md-nav__link">
    Save As Tga
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#save-to-psd" class="md-nav__link">
    Save To Psd
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#selection-stroke" class="md-nav__link">
    Selection Stroke
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#session-callback" class="md-nav__link">
    Session Callback
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#session-document-duplicate" class="md-nav__link">
    Session Document Duplicate
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#session-hello-world" class="md-nav__link">
    Session Hello World
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#session-new-document" class="md-nav__link">
    Session New Document
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#session-smart-sharpen" class="md-nav__link">
    Session Smart Sharpen
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#set-active-layer" class="md-nav__link">
    Set Active Layer
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#smart-sharpen" class="md-nav__link">
    Smart Sharpen
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#toggle-proof-colors" class="md-nav__link">
    Toggle Proof Colors
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#trim" class="md-nav__link">
    Trim
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/loonghao/photoshop-python-api/edit/master/docs/examples.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="examples">Examples</h1>
<h2 id="active-layer">Active Layer</h2>
<pre class="highlight"><code class="language-python"># Set the active layer to the last art layer of the active document, or the
# first if the last is already active.

# Import local modules
from photoshop import Session


with Session() as ps:
    if len(ps.app.documents) &lt; 1:
        docRef = ps.app.documents.add()
    else:
        docRef = ps.app.activeDocument

    if len(docRef.layers) &lt; 2:
        docRef.artLayers.add()

    ps.echo(docRef.activeLayer.name)
    new_layer = docRef.artLayers.add()
    ps.echo(new_layer.name)
    new_layer.name = "test"
</code></pre>
<h2 id="add-metadata">Add Metadata</h2>
<pre class="highlight"><code class="language-python">"""Add metadata to current active document."""

# Import built-in modules
import os

# Import local modules
from photoshop import Session


with Session(action="new_document") as ps:
    doc = ps.active_document
    doc.info.author = os.getenv("USERNAME")
    doc.info.provinceState = "Beijing"
    doc.info.title = "My Demo"
    print("Print all metadata of current active document.")
    ps.echo(doc.info)
</code></pre>
<h2 id="add-slate">Add Slate</h2>
<pre class="highlight"><code class="language-python">"""Add slate information dynamically.

- Open template.
- Update info.
- Save as jpg.
- Close current document.

"""

# Import built-in modules
from datetime import datetime
import os
from tempfile import mkdtemp

# Import third-party modules
import examples._psd_files as psd  # Import from examples.

# Import local modules
from photoshop import Session


PSD_FILE = psd.get_psd_files()
slate_template = PSD_FILE["slate_template.psd"]
with Session(slate_template, action="open", auto_close=True) as ps:
    layer_set = ps.active_document.layerSets.getByName("template")

    data = {
        "project name": "test_project",
        "datetime": datetime.today().strftime("%Y-%m-%d"),
    }
    for layer in layer_set.layers:
        if layer.kind == ps.LayerKind.TextLayer:
            layer.textItem.contents = data[layer.textItem.contents.strip()]

    jpg_file = os.path.join(mkdtemp("photoshop-python-api"), "slate.jpg")
    ps.active_document.saveAs(jpg_file, ps.JPEGSaveOptions())
    print(f"Save jpg to {jpg_file}")
    os.startfile(jpg_file)
</code></pre>
<h2 id="add-start-application-event">Add Start Application Event</h2>
<pre class="highlight"><code class="language-python">"""Add event for Photoshop start application.

In the current example, every time we start photoshop it will
alert "Start Application Event".

Just like you manually in Script&gt; Script Events Manager to enable the event.

"""

# Import built-in modules
import os
from tempfile import mkdtemp

# Import local modules
from photoshop import Session


with Session() as ps:
    root = mkdtemp()
    jsx_file = os.path.join(root, "event.jsx")
    with open(jsx_file, "w") as f:
        f.write('alert("Start Application event.")')
    ps.app.notifiers.add(ps.EventID.Notify, jsx_file)
    print("Add event done.")
</code></pre>
<h2 id="apply-crystallize-filter-action">Apply Crystallize Filter Action</h2>
<pre class="highlight"><code class="language-python">""" This script demonstrates how you can use the action manager

to execute the Crystallize filter.
In order to find all the IDs, see https://helpx.adobe.com/photoshop/kb/downloadable-plugins-and-content.html#ScriptingListenerplugin
This blog here explains what a script listener is http://blogs.adobe.com/crawlspace/2006/05/installing_and_1.html

References:
    https://github.com/lohriialo/photoshop-scripting-python/blob/master/ApplyCrystallizeFilterAction.py

"""

# Import third-party modules
import examples._psd_files as psd  # Import from examples.

# Import local modules
from photoshop import Session


PSD_FILE = psd.get_psd_files()

with Session(PSD_FILE["layer_comps.psd"], "open") as ps:
    active_document = ps.active_document
    nLayerSets = active_document.layerSets
    print(f"The total amount of current layerSet (Group) is " f"{len(nLayerSets)}.")
    nArtLayers = active_document.layerSets.item(len(nLayerSets)).artLayers

    # get the last layer in LayerSets
    active_document.activeLayer = active_document.layerSets.item(
        len(nLayerSets)
    ).artLayers.item(len(nArtLayers))

    def applyCrystallize(cellSize):
        cellSizeID = ps.app.CharIDToTypeID("ClSz")
        eventCrystallizeID = ps.app.CharIDToTypeID("Crst")

        filterDescriptor = ps.ActionDescriptor
        filterDescriptor.putInteger(cellSizeID, cellSize)

        ps.app.executeAction(eventCrystallizeID, filterDescriptor)

    applyCrystallize(25)
    print("Apply crystallize done.")
</code></pre>
<h2 id="apply-filters">Apply Filters</h2>
<pre class="highlight"><code class="language-python">"""
References:
    https://github.com/lohriialo/photoshop-scripting-python/blob/master/ApplyFilters.py

"""
# Import built-in modules
import os

# Import third-party modules
import examples._psd_files as psd  # Import from examples.

# Import local modules
# selections in the open document.
import photoshop.api as ps


PSD_FILE = psd.get_psd_files()

# Start up Photoshop application
app = ps.Application()

# We don't want any Photoshop dialogs displayed during automated execution
app.displayDialogs = ps.DialogModes.DisplayNoDialogs

psPixels = 1
start_ruler_units = app.preferences.rulerUnits
if start_ruler_units is not psPixels:
    app.preferences.rulerUnits = psPixels

fileName = PSD_FILE["layer_comps.psd"]
docRef = app.open(fileName)
nLayerSets = len(list((i, x) for i, x in enumerate(docRef.layerSets))) - 1
nArtLayers = len(
    list((i, x) for i, x in enumerate(docRef.layerSets[nLayerSets].artLayers)),
)

active_layer = docRef.activeLayer = docRef.layerSets[nLayerSets].artLayers[nArtLayers]
sel_area = ((0, 212), (300, 212), (300, 300), (0, 300))
docRef.selection.select(sel_area, ps.SelectionType.ReplaceSelection, 20, True)
print(f"Current active layer: {active_layer.name}")
active_layer.applyAddNoise(15, ps.NoiseDistribution.GaussianNoise, False)

backColor = ps.SolidColor()
backColor.hsb.hue = 0
backColor.hsb.saturation = 0
backColor.hsb.brightness = 100
app.backgroundColor = backColor

sel_area2 = ((120, 20), (210, 20), (210, 110), (120, 110))
docRef.selection.select(sel_area2, ps.SelectionType.ReplaceSelection, 25, False)
active_layer.applyDiffuseGlow(9, 12, 15)
active_layer.applyGlassEffect(
    7,
    3,
    7,
    False,
    ps.TextureType.TinyLensTexture,
    None,
)
docRef.selection.deselect()

# Set ruler units back the way we found it.
if start_ruler_units is not psPixels:
    app.Preferences.RulerUnits = start_ruler_units
</code></pre>
<h2 id="change-color-of-background-and-foreground">Change Color Of Background And Foreground</h2>
<pre class="highlight"><code class="language-python">"""Change the color of the background and foreground."""
# Import local modules
from photoshop import Session


with Session() as ps:
    foregroundColor = ps.SolidColor()
    foregroundColor.rgb.red = 255
    foregroundColor.rgb.green = 0
    foregroundColor.rgb.blue = 0
    ps.app.foregroundColor = foregroundColor

    backgroundColor = ps.SolidColor()
    backgroundColor.rgb.red = 0
    backgroundColor.rgb.green = 0
    backgroundColor.rgb.blue = 0
    ps.app.backgroundColor = backgroundColor
</code></pre>
<h2 id="color">Color</h2>
<pre class="highlight"><code class="language-python"># Import local modules
from photoshop import Session


with Session() as ps:
    doc = ps.active_document
    # Add a solid color.
    textColor = ps.SolidColor()
    textColor.rgb.red = 255.0
    textColor.rgb.green = 197
    textColor.rgb.blue = 255

    # Create empty layer.
    new_text_layer = doc.artLayers.add()
    # Set empty layer type to text layer
    new_text_layer.kind = ps.LayerKind.TextLayer
    # Set current text layer contents to "Hello, World!".
    new_text_layer.textItem.contents = "Hello, World!"
    # Change current text layer position.
    new_text_layer.textItem.position = [160, 167]
    # Change current text layer text size.
    new_text_layer.textItem.size = 36
    # Change current text layer color.
    new_text_layer.textItem.color = textColor
    assert new_text_layer.textItem.color.rgb.red == textColor.rgb.red
</code></pre>
<h2 id="compare-colors">Compare Colors</h2>
<pre class="highlight"><code class="language-python">"""Check whether the foreground is equal to the background color.

References:
    https://github.com/lohriialo/photoshop-scripting-python/blob/master/CompareColors.py

"""
# Import local modules
from photoshop import Session


with Session() as ps:
    if ps.app.foregroundColor.isEqual(ps.app.backgroundColor):
        ps.echo("They're Equal.")
    else:
        ps.echo("NOT Equal.")
</code></pre>
<h2 id="copy-and-paste">Copy And Paste</h2>
<pre class="highlight"><code class="language-python">"""
References:
    https://github.com/lohriialo/photoshop-scripting-python/blob/master/CopyAndPaste.py

"""

# Import local modules
import photoshop.api as ps


app = ps.Application()

startRulerUnits = app.preferences.rulerUnits

app.preferences.rulerUnits = ps.Units.Inches

doc = app.documents.add(
    7, 5, 72, None, ps.NewDocumentMode.NewRGB, ps.DocumentFill.White
)

# Make sure the active layer is not a text layer, which cannot be copied to the
# clipboard.
if doc.activeLayer.kind != ps.LayerKind.TextLayer:
    # Select the left half of the document. Selections are always expressed
    # in pixels regardless of the current ruler unit type, so we're computing
    # the selection corner points based on the inch unit width and height
    # of the document
    x2 = (doc.width * doc.resolution) / 2
    y2 = doc.height * doc.resolution

    sel_area = ((0, 0), (x2, 0), (x2, y2), (0, y2))
    doc.selection.select(sel_area, ps.SelectionType.ReplaceSelection, 0, False)

    doc.selection.copy()

    # The new doc is created
    # need to change ruler units to pixels because x2 and y2 are pixel units.
    app.preferences.rulerUnits = ps.Units.Pixels
    pasteDoc = app.documents.add(x2, y2, doc.resolution, "Paste Target")
    pasteDoc.paste()
else:
    print("You cannot copy from a text layer")

if startRulerUnits != app.preferences.rulerUnits:
    app.preferences.rulerUnits = startRulerUnits
</code></pre>
<h2 id="create-new-document">Create New Document</h2>
<pre class="highlight"><code class="language-python">"""Create a new document."""

# Import local modules
from photoshop import Session


with Session() as ps:
    ps.app.preferences.rulerUnits = ps.Units.Pixels
    ps.app.documents.add(1920, 1080, name="my_new_document")
</code></pre>
<h2 id="create-thumbnail">Create Thumbnail</h2>
<pre class="highlight"><code class="language-python">"""Create a thumbnail image for currently active document.

You can use the thumbnail image to upload to Shotgun or Ftrack.

"""

# Import built-in modules
import os
from tempfile import mkdtemp

# Import local modules
from photoshop import Session


def create_thumbnail(output_path=None, max_resolution=512):
    """Create a thumbnail image for currently active document.

    Args:
        output_path (str): The absolute output path of the thumbnail image.
            The default is to output to a temporary folder.
        max_resolution (int): The max resolution of the thumbnail. The default
            is `512`.

    Returns:
        str: The absolute output path of the thumbnail image.

    """
    output_path = output_path or os.path.join(mkdtemp(), "thumb.jpg")

    with Session(auto_close=True) as ps:
        orig_name = ps.active_document.name
        width_str = ps.active_document.width
        height_str = ps.active_document.height
        thumb_name = f"{orig_name}_thumb"

        max_resolution = width_str / max_resolution
        thumb_width = int(width_str / max_resolution)
        thumb_height = int(height_str / max_resolution)

        thumb_doc = ps.active_document.duplicate(thumb_name)
        thumb_doc.resizeImage(thumb_width, thumb_height - 100)
        thumb_doc.saveAs(output_path, ps.JPEGSaveOptions(), asCopy=True)
        thumb_doc.close()
        return output_path


if __name__ == "__main__":
    thumb_file = create_thumbnail()
    print(f"Save thumbnail file to {thumb_file}.")
</code></pre>
<h2 id="creating-a-layer">Creating A Layer</h2>
<pre class="highlight"><code class="language-python">"""
Let's get the current document and create a new layer "Background" and fill it
with red color. In order to use the Fill tool we will first select the entire
layer and then fill it with a color.

"""

# Import local modules
from photoshop import Session


with Session() as ps:
    document = ps.active_document
    # Create color object of color red.
    fillColor = ps.SolidColor()
    fillColor.rgb.red = 222
    fillColor.rgb.green = 0
    fillColor.rgb.blue = 0
    # Add a new layer called Background.
    layer = document.artLayers.add()
    layer.name = "Background"
    # Select the entire layer.
    document.selection.selectAll()
    # Fill the selection with color.
    document.selection.fill(fillColor)
    # Deselect.
    document.selection.deselect()
</code></pre>
<h2 id="cropping">Cropping</h2>
<pre class="highlight"><code class="language-python">"""A cropping example."""

# Import local modules
from photoshop import Session


with Session(action="new_document") as ps:
    ps.active_document.crop(bounds=[100, 12, 354, 246], width=1920, height=1080)
</code></pre>
<h2 id="current-tool">Current Tool</h2>
<pre class="highlight"><code class="language-python"># Import local modules
from photoshop import Session


with Session() as ps:
    # Print the current tool.
    ps.echo(ps.app.currentTool)

    # Set current tool to `typeCreateOrEditTool`.
    ps.app.currentTool = "typeCreateOrEditTool"
</code></pre>
<h2 id="do-photoshop-action">Do Photoshop Action</h2>
<pre class="highlight"><code class="language-python">"""Do a photoshop action."""
from photoshop import Session

with Session() as api:
    api.app.doAction(action="Frame Channel - 50 pixel")
</code></pre>
<h2 id="emboss-action">Emboss Action</h2>
<pre class="highlight"><code class="language-python"># Import local modules
from photoshop import Session


with Session() as ps:
    app = ps.app
    for index, x in enumerate(range(50)):
        # Execute an existing action from action palette.
        idPly = app.charIDToTypeID("Ply ")
        desc8 = ps.ActionDescriptor()
        idnull = app.charIDToTypeID("null")
        ref3 = ps.ActionReference()
        idActn = app.charIDToTypeID("Actn")
        ref3.putName(idActn, "Sepia Toning (layer)")
        idASet = app.charIDToTypeID("ASet")
        ref3.PutName(idASet, "Default Actions")
        desc8.putReference(idnull, ref3)
        app.executeAction(idPly, desc8, ps.DialogModes.DisplayNoDialogs)

        # Create solid color fill layer.
        idMk = app.charIDToTypeID("Mk  ")
        desc21 = ps.ActionDescriptor()
        idNull = app.charIDToTypeID("null")
        ref12 = ps.ActionReference()
        idContentLayer1 = app.stringIDToTypeID("contentLayer")
        ref12.putClass(idContentLayer1)
        desc21.putReference(idNull, ref12)
        idUsng = app.charIDToTypeID("Usng")
        desc22 = ps.ActionDescriptor()
        idType = app.charIDToTypeID("Type")
        desc23 = ps.ActionDescriptor()
        idClr = app.charIDToTypeID("Clr ")
        desc24 = ps.ActionDescriptor()
        idRd = app.charIDToTypeID("Rd  ")
        desc24.putDouble(idRd, index)
        idGrn = app.charIDToTypeID("Grn ")
        desc24.putDouble(idGrn, index)
        idBl = app.charIDToTypeID("Bl  ")
        desc24.putDouble(idBl, index)
        idRGBC = app.charIDToTypeID("RGBC")
        desc23.putObject(idClr, idRGBC, desc24)
        idSolidColorLayer = app.StringIDToTypeID("solidColorLayer")
        desc22.putObject(idType, idSolidColorLayer, desc23)
        idContentLayer2 = app.StringIDToTypeID("contentLayer")
        desc21.putObject(idUsng, idContentLayer2, desc22)
        app.executeAction(idMk, desc21, ps.DialogModes.DisplayNoDialogs)

        # Select mask.
        idSlct = app.charIDToTypeID("slct")
        desc38 = ps.ActionDescriptor()
        idNull1 = app.charIDToTypeID("null")
        ref20 = ps.ActionReference()
        idChnl1 = app.charIDToTypeID("Chnl")
        idChnl2 = app.charIDToTypeID("Chnl")
        idMsk = app.charIDToTypeID("Msk ")
        ref20.putEnumerated(idChnl1, idChnl2, idMsk)
        desc38.putReference(idNull1, ref20)
        idMkVs = app.charIDToTypeID("MkVs")
        desc38.putBoolean(idMkVs, False)
        app.executeAction(idSlct, desc38, ps.DialogModes.DisplayNoDialogs)

        app.activeDocument.activeLayer.invert()
</code></pre>
<h2 id="enable-generator">Enable Generator</h2>
<pre class="highlight"><code class="language-python">"""Enable Generator features."""
# Import local modules
from photoshop import Session


with Session() as ps:
    plugin_name = "generator-assets-dummy-menu"
    generatorDesc = ps.ActionDescriptor
    generatorDesc.putString(ps.app.stringIDToTypeID("name"), plugin_name)
    ps.app.executeAction(ps.app.stringIDToTypeID("generateAssets"), generatorDesc)
</code></pre>
<h2 id="eval-javascript">Eval Javascript</h2>
<pre class="highlight"><code class="language-python"># Import local modules
import photoshop.api as ps


app = ps.Application()
jsx = r"""
var doc = app.activeDocument;
var orig_name = doc.name;
alert(orig_name);
"""
app.doJavaScript(jsx)


# Print name of current active document.
print(app.doJavaScript("app.activeDocument.name"))
</code></pre>
<h2 id="export-layers-as-png">Export Layers As Png</h2>
<pre class="highlight"><code class="language-python">"""Export every layer as a .png file."""
# Import built-in modules
import os

# Import third-party modules
import examples._psd_files as psd  # Import from examples.

# Import local modules
from photoshop import Session


PSD_FILE = psd.get_psd_files()


def hide_all_layers(layers):
    for layer in layers:
        layer.visible = False


def main():
    psd_file = PSD_FILE["export_layers_as_png.psd"]
    with Session(psd_file, action="open") as ps:
        doc = ps.active_document
        options = ps.PNGSaveOptions()
        layers = doc.artLayers
        for layer in layers:
            hide_all_layers(layers)
            layer.visible = True
            layer_path = os.path.join(doc.path, layer.name)
            print(layer_path)
            if not os.path.exists(layer_path):
                os.makedirs(layer_path)
            image_path = os.path.join(layer_path, f"{layer.name}.png")
            doc.saveAs(image_path, options, True)
        ps.alert("Task done!")
        ps.echo(doc.activeLayer)


if __name__ == "__main__":
    main()
</code></pre>
<h2 id="fill-selection">Fill Selection</h2>
<pre class="highlight"><code class="language-python"># Fill the current selection with an RGB color.


# Import local modules
from photoshop import Session


with Session() as ps:
    start_ruler_units = ps.app.Preferences.RulerUnits

    if len(ps.app.documents) &lt; 1:
        if start_ruler_units is not ps.Units.Pixels:
            ps.app.Preferences.RulerUnits = ps.Units.Pixels
        docRef = ps.app.documents.add(
            320, 240, 72, None, ps.NewDocumentMode.NewRGB, ps.DocumentFill.White
        )
        docRef.artLayers.add()
        ps.app.preferences.rulerUnits = start_ruler_units

    if not ps.active_document.activeLayer.isBackgroundLayer:
        selRef = ps.active_document.selection
        fillcolor = ps.SolidColor()
        fillcolor.rgb.red = 225
        fillcolor.rgb.green = 0
        fillcolor.rgb.blue = 0
        selRef.fill(fillcolor, ps.ColorBlendMode.NormalBlendColor, 25, False)
    else:
        ps.echo("Can't perform operation on background layer.")
</code></pre>
<h2 id="fit-on-screen">Fit On Screen</h2>
<pre class="highlight"><code class="language-python">"""Let the current document Fit on screen."""

# Import local modules
from photoshop import Session


with Session() as ps:
    ps.app.runMenuItem(ps.app.charIDToTypeID("FtOn"))
</code></pre>
<h2 id="hello-world">Hello World</h2>
<pre class="highlight"><code class="language-python"># Import built-in modules
import os
from tempfile import mkdtemp

# Import local modules
import photoshop.api as ps


def hello_world():
    app = ps.Application()
    doc = app.documents.add()
    text_color = ps.SolidColor()
    text_color.rgb.green = 255
    new_text_layer = doc.artLayers.add()
    new_text_layer.kind = ps.LayerKind.TextLayer
    new_text_layer.textItem.contents = "Hello, World!"
    new_text_layer.textItem.position = [160, 167]
    new_text_layer.textItem.size = 40
    new_text_layer.textItem.color = text_color
    options = ps.JPEGSaveOptions(quality=5)
    jpg_file = os.path.join(mkdtemp("photoshop-python-api"), "hello_world.jpg")
    doc.saveAs(jpg_file, options, asCopy=True)
    os.startfile(jpg_file)


if __name__ == "__main__":
    hello_world()
</code></pre>
<h2 id="import-image-as-layer">Import Image As Layer</h2>
<pre class="highlight"><code class="language-python">"""Import a image as a artLayer."""

# Import local modules
from photoshop import Session


with Session(action="new_document") as ps:
    desc = ps.ActionDescriptor
    desc.putPath(ps.app.charIDToTypeID("null"), "your/image/path")
    event_id = ps.app.charIDToTypeID("Plc ")  # `Plc` need one space in here.
    ps.app.executeAction(ps.app.charIDToTypeID("Plc "), desc)
</code></pre>
<h2 id="link-layer">Link Layer</h2>
<pre class="highlight"><code class="language-python"># Import local modules
import photoshop.api as ps


app = ps.Application()

start_ruler_units = app.preferences.rulerUnits

if len(app.documents) &lt; 1:
    if start_ruler_units is not ps.Units.Pixels:
        app.preferences.rulerUnits = ps.Units.Pixels
    docRef = app.documents.add(
        320,
        240,
        72,
        None,
        ps.NewDocumentMode.NewRGB,
        ps.DocumentFill.BackgroundColor,
    )
else:
    docRef = app.activeDocument

layerRef = docRef.artLayers.add()
layerRef2 = docRef.artLayers.add()
layerRef.link(layerRef2)

# Set the ruler back to where it was
app.preferences.rulerUnits = start_ruler_units
</code></pre>
<h2 id="list-documents">List Documents</h2>
<pre class="highlight"><code class="language-python">"""List current photoshop all documents."""

# Import local modules
import photoshop.api as ps


app = ps.Application()

doc = app.documents[0]
print(doc.name)

for doc in app.documents:
    print(doc.name)
</code></pre>
<h2 id="load-selection">Load Selection</h2>
<pre class="highlight"><code class="language-python"># This script will demonstrate how to load a selection from a saved alpha
# channel.

# Import local modules
from photoshop import Session


with Session() as ps:
    doc_ref = ps.app.documents.add(320, 240)
    start_ruler_units = ps.app.preferences.rulerUnits
    if start_ruler_units is not ps.Units.Pixels:
        ps.app.Preferences.RulerUnits = ps.Units.Pixels
    # Save a rectangular selection area offset by 50 pixels from the image
    # border into an alpha channel.
    offset = 50
    selBounds1 = (
        (offset, offset),
        (doc_ref.Width - offset, offset),
        (doc_ref.Width - offset, doc_ref.Height - offset),
        (offset, doc_ref.Height - offset),
    )
    doc_ref.selection.select(selBounds1)
    selAlpha = doc_ref.channels.Add()
    doc_ref.selection.store(selAlpha)

    # Now create a second wider but less tall selection.
    selBounds2 = ((0, 75), (doc_ref.Width, 75), (doc_ref.Width, 150), (0, 150))
    doc_ref.selection.select(selBounds2)

    # Load the selection from the just saved alpha channel, combining it with
    # the active selection.
    doc_ref.selection.load(selAlpha, ps.SelectionType.ExtendSelection, False)

    # Set ruler back to where it was.
    ps.app.Preferences.RulerUnits = start_ruler_units
</code></pre>
<h2 id="move-to-end">Move To End</h2>
<pre class="highlight"><code class="language-python"># Import local modules
import photoshop.api as ps


# Get photoshop instance.
app = ps.Application()

# Add new document and set name to "Example for move to End."
active_document = app.documents.add(name="Example for move to End.")

# Add a new layer set.
group_layer = active_document.layerSets.add()
# Add a layer in the group.
layer = group_layer.artLayers.add()
layer.name = "This is a child layer."
# Add a new layer in this active document top.
top_layer = active_document.artLayers.add()
top_layer.name = "This is a top layer."
top_layer.moveToEnd(group_layer)
</code></pre>
<h2 id="new-document">New Document</h2>
<pre class="highlight"><code class="language-python"># Create a new Photoshop document with diminsions 4 inches by 4 inches.
# Import local modules
import photoshop.api as ps


# Start up Photoshop application
app = ps.Application()

start_ruler_units = app.preferences.rulerUnits

app.preferences.rulerUnits = ps.Units.Pixels

# Create the document
docRef = app.documents.add(1920, 1080, 72.0, "My New Document")

# Make sure to set the ruler units prior to creating the document.
app.preferences.rulerUnits = start_ruler_units
</code></pre>
<h2 id="open-psd">Open Psd</h2>
<pre class="highlight"><code class="language-python"># Import local modules
from photoshop import Session
import photoshop.api as ps


# style 1
app = ps.Application()
app.load("your/psd/or/psb/file_path.psd")

# style 2
with Session("your/psd/or/psb/file_path.psd", action="open") as ps:
    ps.echo(ps.active_document.name)
</code></pre>
<h2 id="operation-channels">Operation Channels</h2>
<pre class="highlight"><code class="language-python">"""A examples to show you how to operation active document channels."""

# Import local modules
from photoshop import Session


with Session() as ps:
    doc = ps.active_document
    print(len(doc.channels))
    doc.channels.add()
    doc.channels.removeAll()
    channel = doc.channels.getByName("Red")
    print(channel.name)
    channel.remove()
</code></pre>
<h2 id="operation-layer-set">Operation Layer Set</h2>
<pre class="highlight"><code class="language-python">"""A examples to show you how to operation layerSet."""

# Import local modules
from photoshop import Session


with Session(action="new_document") as ps:
    docRef = ps.active_document
    # Add a new layerSet.
    new_layer_set = docRef.layerSets.add()
    # Print the layerSet count.
    ps.echo(docRef.layerSets.length)
    ps.echo(len(docRef.layerSets))
    # Rename the layerSet.
    docRef.layerSets[0].name = "New Name"
    ps.echo(new_layer_set.name)

    # Change the layerSet opacity
    new_layer_set.opacity = 90
    ps.echo(new_layer_set.opacity)

    # Duplicate the layerSet.
    duplicate_layer_set = new_layer_set.duplicate()
    # Add a new artLayer in current active document.
    layer = docRef.artLayers.add()
    # Move the artLayer under the duplicate layerSet.
    layer.move(duplicate_layer_set, ps.ElementPlacement.PlaceInside)
    # Merge the layerSet.
    merged_layer = duplicate_layer_set.merge()
    ps.echo(merged_layer.name)

    # Set visible.
    new_layer_set.visible = False

    merged_layer.remove()
</code></pre>
<h2 id="photoshop-session">Photoshop Session</h2>
<pre class="highlight"><code class="language-python">"""Add slate information dynamically."""

# Import built-in modules
from datetime import datetime
import os
from tempfile import mkdtemp

# Import third-party modules
import examples._psd_files as psd  # Import from examples.

# Import local modules
from photoshop import Session


PSD_FILE = psd.get_psd_files()
file_path = PSD_FILE["slate_template.psd"]

with Session(file_path, action="open", auto_close=True) as ps:
    layer_set = ps.active_document.layerSets.getByName("template")
    data = {
        "project name": "test_project",
        "datetime": datetime.today().strftime("%Y-%m-%d"),
    }
    for layer in layer_set.layers:
        if layer.kind == ps.LayerKind.TextLayer:
            layer.textItem.contents = data[layer.textItem.contents.strip()]

    jpg_file = os.path.join(mkdtemp("photoshop-python-api"), "slate.jpg")
    ps.active_document.saveAs(jpg_file, ps.JPEGSaveOptions())
    os.startfile(jpg_file)
</code></pre>
<h2 id="replace-images">Replace Images</h2>
<pre class="highlight"><code class="language-python">"""Replace the image of the current active layer with a new image."""


# Import local modules
from photoshop import Session


with Session() as ps:
    replace_contents = ps.app.stringIDToTypeID("placedLayerReplaceContents")
    desc = ps.ActionDescriptor
    idnull = ps.app.charIDToTypeID("null")
    desc.putPath(idnull, "your/image/path.jpg")
    ps.app.executeAction(replace_contents, desc)
</code></pre>
<h2 id="rotate-layer">Rotate Layer</h2>
<pre class="highlight"><code class="language-python">"""This scripts demonstrates how to rotate a layer 45 degrees clockwise.

References:
    https://github.com/lohriialo/photoshop-scripting-python/blob/master/RotateLayer.py

"""

# Import local modules
import photoshop.api as ps


app = ps.Application()

if len(app.documents) &gt; 0:
    print(app.activeDocument.activeLayer.typename)
    if not app.activeDocument.activeLayer.isBackgroundLayer:
        docRef = app.activeDocument
        layerRef = docRef.layers[0]
        layerRef.rotate(45.0)
    else:
        print("Operation cannot be performed on background layer")
else:
    print("You must have at least one open document to run this script!")
</code></pre>
<h2 id="save-as-pdf">Save As Pdf</h2>
<pre class="highlight"><code class="language-python">"""Save current active document as a PDF file."""
# Import built-in modules
import os
from tempfile import mkdtemp

# Import local modules
from photoshop import Session


with Session() as ps:
    option = ps.PDFSaveOptions(jpegQuality=12, layers=True, view=True)
    pdf = os.path.join(mkdtemp(), "test.pdf")
    ps.active_document.saveAs(pdf, option)

with Session() as ps:
    option = ps.PDFSaveOptions()
    option.jpegQuality = 12
    option.layers = True
    option.view = True  # opens the saved PDF in Acrobat.
    pdf = os.path.join(mkdtemp(), "test.pdf")
    ps.active_document.saveAs(pdf, option)
</code></pre>
<h2 id="save-as-tga">Save As Tga</h2>
<pre class="highlight"><code class="language-python"># Import built-in modules
import os
from tempfile import mkdtemp

# Import local modules
from photoshop import Session


with Session(action="new_document") as ps:
    doc = ps.active_document
    text_color = ps.SolidColor()
    text_color.rgb.green = 255
    text_color.rgb.red = 0
    text_color.rgb.blue = 0
    new_text_layer = doc.artLayers.add()
    new_text_layer.kind = ps.LayerKind.TextLayer
    new_text_layer.textItem.contents = "Hello, World!"
    new_text_layer.textItem.position = [160, 167]
    new_text_layer.textItem.size = 40
    new_text_layer.textItem.color = text_color
    tga_file = os.path.join(mkdtemp("photoshop-python-api"), "test.tga")
    doc.saveAs(tga_file, ps.TargaSaveOptions(), asCopy=True)
    os.startfile(tga_file)
</code></pre>
<h2 id="save-to-psd">Save To Psd</h2>
<pre class="highlight"><code class="language-python">"""Save your current active document as a .psd file."""
# Import local modules
from photoshop import Session


with Session() as ps:
    psd_file = "your/psd/save/file/path.psd"
    doc = ps.active_document
    options = ps.PhotoshopSaveOptions()
    layers = doc.artLayers
    doc.saveAs(psd_file, options, True)
    ps.alert("Task done!")
    ps.echo(doc.activeLayer)
</code></pre>
<h2 id="selection-stroke">Selection Stroke</h2>
<pre class="highlight"><code class="language-python">"""Create a stroke around the current selection, Set the stroke color and
width of the new stroke.

References:
    https://github.com/lohriialo/photoshop-scripting-python/blob/master/SelectionStroke.py

"""

# Import local modules
import photoshop.api as ps


app = ps.Application()

if len(list((i, x) for i, x in enumerate(app.documents, 1))) &gt; 0:
    if not app.activeDocument.activeLayer.isBackgroundLayer:
        psPixels = 1
        start_ruler_units = app.Preferences.RulerUnits
        app.preferences.rulerUnits = ps.Units.Pixels

        selRef = app.activeDocument.selection
        offset = 10
        selBounds = (
            (offset, offset),
            (app.activeDocument.width - offset, offset),
            (app.activeDocument.width - offset, app.activeDocument.height - offset),
            (offset, app.activeDocument.height - offset),
        )

        selRef.select(selBounds)
        selRef.selectBorder(5)

        # create text color properties
        strokeColor = ps.SolidColor()

        strokeColor.cmyk.cyan = 58
        strokeColor.cmyk.magenta = 0
        strokeColor.cmyk.yellow = 70
        strokeColor.cmyk.black = 0
        app.displayDialogs = ps.DialogModes.DisplayNoDialogs
        selRef.stroke(
            strokeColor,
            2,
            ps.StrokeLocation.OutsideStroke,
            ps.ColorBlendMode.ColorBlendMode,
            75,
            True,
        )

        # Set ruler units back the way we found it.
        app.preferences.rulerUnits = start_ruler_units
    else:
        print("Operation cannot be performed on background layer")
else:
    print("Create a document with an active selection before running this " "script!")
</code></pre>
<h2 id="session-callback">Session Callback</h2>
<pre class="highlight"><code class="language-python"># Import local modules
from photoshop import Session


def do_something(photoshop_api):
    print(photoshop_api.active_document)
    print("Do something.")


with Session(callback=do_something) as ps:
    ps.echo(ps.active_document.name)
    ps.alert(ps.active_document.name)
</code></pre>
<h2 id="session-document-duplicate">Session Document Duplicate</h2>
<pre class="highlight"><code class="language-python">"""Action for duplicate current active document."""
# Import local modules
from photoshop import Session


with Session(action="document_duplicate") as ps:
    ps.echo(ps.active_document.name)
</code></pre>
<h2 id="session-hello-world">Session Hello World</h2>
<pre class="highlight"><code class="language-python">"""Add slate information dynamically."""

# Import built-in modules
import os
from tempfile import mkdtemp

# Import local modules
from photoshop import Session


with Session() as adobe:
    doc = adobe.app.documents.add(2000, 2000)
    text_color = adobe.SolidColor()
    text_color.rgb.red = 255
    new_text_layer = doc.artLayers.add()
    new_text_layer.kind = adobe.LayerKind.TextLayer
    new_text_layer.textItem.contents = "Hello, World!"
    new_text_layer.textItem.position = [160, 167]
    new_text_layer.textItem.size = 40
    new_text_layer.textItem.color = text_color
    options = adobe.JPEGSaveOptions(quality=1)
    jpg_file = os.path.join(mkdtemp("photoshop-python-api"), "hello_world.jpg")
    doc.saveAs(jpg_file, options, asCopy=True)
    adobe.app.doJavaScript(f'alert("save to jpg: {jpg_file}")')
</code></pre>
<h2 id="session-new-document">Session New Document</h2>
<pre class="highlight"><code class="language-python">"""Action for create new document and print new document name."""
# Import local modules
from photoshop import Session


with Session(action="new_document") as ps:
    ps.echo(ps.active_document.name)
</code></pre>
<h2 id="session-smart-sharpen">Session Smart Sharpen</h2>
<pre class="highlight"><code class="language-python">"""This script demonstrates how you can use the action manager to execute the
Emboss filter.

References:
    https://github.com/lohriialo/photoshop-scripting-python/blob/master/SmartSharpen.py

"""

# Import third-party modules
import examples._psd_files as psd  # Import from examples.

# Import local modules
from photoshop import Session


PSD_FILE = psd.get_psd_files()
file_path = PSD_FILE["layer_comps.psd"]

with Session(file_path, action="open") as ps:

    def SmartSharpen(inAmount, inRadius, inNoise):
        idsmart_sharpen_id = ps.app.stringIDToTypeID(ps.EventID.SmartSharpen)
        desc37 = ps.ActionDescriptor()

        idpresetKind = ps.app.stringIDToTypeID(ps.EventID.PresetKind)
        idpresetKindType = ps.app.stringIDToTypeID(ps.EventID.PresetKindType)
        idpresetKindCustom = ps.app.stringIDToTypeID(ps.EventID.PresetKindCustom)
        desc37.putEnumerated(idpresetKind, idpresetKindType, idpresetKindCustom)
        idAmnt = ps.app.charIDToTypeID("Amnt")
        idPrc = ps.app.charIDToTypeID("Rds ")
        desc37.putUnitDouble(idAmnt, idPrc, inAmount)

        idRds = ps.app.charIDToTypeID("Rds ")
        idPxl = ps.app.charIDToTypeID("#Pxl")
        desc37.putUnitDouble(idRds, idPxl, inRadius)

        idnoiseReduction = ps.app.stringIDToTypeID("noiseReduction")
        idPrc = ps.app.charIDToTypeID("#Prc")
        desc37.putUnitDouble(idnoiseReduction, idPrc, inNoise)

        idblur = ps.app.charIDToTypeID("blur")
        idblurType = ps.app.stringIDToTypeID("blurType")
        idGsnB = ps.app.charIDToTypeID("GsnB")
        desc37.putEnumerated(idblur, idblurType, idGsnB)

        ps.app.ExecuteAction(idsmart_sharpen_id, desc37)

    docRef = ps.active_document
    nlayerSets = docRef.layerSets
    nArtLayers = docRef.layerSets.item(nlayerSets.length)
    docRef.activeLayer = nArtLayers.artLayers.item(nArtLayers.artLayers.length)

    SmartSharpen(300, 2.0, 20)
</code></pre>
<h2 id="set-active-layer">Set Active Layer</h2>
<pre class="highlight"><code class="language-python">"""
References:
    https://github.com/lohriialo/photoshop-scripting-python/blob/master/ActiveLayer.py

"""
# Import local modules
import photoshop.api as ps


app = ps.Application()

if app.documents.length &lt; 1:
    docRef = app.documents.add()
else:
    docRef = app.activeDocument

if docRef.layers.length &lt; 2:
    docRef.artLayers.add()

activeLayerName = docRef.activeLayer.name
if docRef.activeLayer.name != docRef.layers.item(docRef.layers.length).name:
    docRef.activeLayer = docRef.layers.item(docRef.layers.length)
else:
    docRef.activeLayer = docRef.layers.item(1)
</code></pre>
<h2 id="smart-sharpen">Smart Sharpen</h2>
<pre class="highlight"><code class="language-python">"""This script demonstrates how you can use the action manager to execute the
Emboss filter.

References:
    https://github.com/lohriialo/photoshop-scripting-python/blob/master/SmartSharpen.py

"""

# Import third-party modules
import examples._psd_files as psd  # Import from examples.

# Import local modules
import photoshop.api as ps


app = ps.Application()

PSD_FILE = psd.get_psd_files()
file_path = PSD_FILE["layer_comps.psd"]
docRef = app.open(file_path)

nlayerSets = docRef.layerSets
nArtLayers = docRef.layerSets.item(nlayerSets.length)
docRef.activeLayer = nArtLayers.artLayers.item(nArtLayers.artLayers.length)


def SmartSharpen(inAmount, inRadius, inNoise):
    idsmart_sharpen_id = app.stringIDToTypeID(ps.EventID.SmartSharpen)
    desc37 = ps.ActionDescriptor()

    idpresetKind = app.stringIDToTypeID(ps.EventID.PresetKind)
    idpresetKindType = app.stringIDToTypeID(ps.EventID.PresetKindType)
    idpresetKindCustom = app.stringIDToTypeID(ps.EventID.PresetKindCustom)
    desc37.putEnumerated(idpresetKind, idpresetKindType, idpresetKindCustom)

    idAmnt = app.charIDToTypeID("Amnt")
    idPrc = app.charIDToTypeID("Rds ")
    desc37.putUnitDouble(idAmnt, idPrc, inAmount)

    idRds = app.charIDToTypeID("Rds ")
    idPxl = app.charIDToTypeID("#Pxl")
    desc37.putUnitDouble(idRds, idPxl, inRadius)

    idnoiseReduction = app.stringIDToTypeID("noiseReduction")
    idPrc = app.charIDToTypeID("#Prc")
    desc37.putUnitDouble(idnoiseReduction, idPrc, inNoise)

    idblur = app.charIDToTypeID("blur")
    idblurType = app.stringIDToTypeID("blurType")
    idGsnB = app.charIDToTypeID("GsnB")
    desc37.putEnumerated(idblur, idblurType, idGsnB)

    app.ExecuteAction(idsmart_sharpen_id, desc37)


SmartSharpen(300, 2.0, 20)
</code></pre>
<h2 id="toggle-proof-colors">Toggle Proof Colors</h2>
<pre class="highlight"><code class="language-python">"""Toggle the proof color.

Like operating in the menu:
**View** &gt; **Proof Colors** (Ctrl + Y)

"""
# Import local modules
from photoshop import Session


with Session() as ps:
    ps.app.runMenuItem(ps.app.stringIDToTypeID("toggleProofColors"))
</code></pre>
<h2 id="trim">Trim</h2>
<pre class="highlight"><code class="language-python">"""A trim example."""

# Import third-party modules
import examples._psd_files as psd  # Import from examples.

# Import local modules
from photoshop import Session


PSD_FILE = psd.get_psd_files()
example_file = PSD_FILE["trim.psd"]
with Session(example_file, action="open") as ps:
    ps.active_document.trim(ps.TrimType.TopLeftPixel, True, True, True, True)
</code></pre>
                
                  
                    

<hr>
<div class="md-source-date">
  <small>
    
      Last update: 2021-10-17
    
  </small>
</div>
                  
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href=".." class="md-footer__link md-footer__link--prev" aria-label="Previous: Introduction" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Introduction
            </div>
          </div>
        </a>
      
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright (c) 2019 Long Hao
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../assets/javascripts/workers/search.709b4209.min.js", "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.29db7785.min.js"></script>
      
    
  </body>
</html>